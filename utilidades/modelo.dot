digraph ERDiagram {
  node [shape=record fontname="Courier"];

  "USUARIO" [label="{USUARIO|PK id\l   nombre: string\lUK correo: string\l   contraseña: string\l   fecha de registro: date\l   estado: string\l}"];
  "ROL" [label="{ROL|PK id\lUK nombre: string\l   descripción: string\l}"];
  "USUARIO ROL" [label="{USUARIO ROL|PK id\lFK usuario\lFK rol\l}"];
  "SUSCRIPCIÓN" [label="{SUSCRIPCIÓN|PK id\lFK usuario\lFK plan\l   fecha de inicio: date\l   fecha de fin: date\l   estado: string\l}"];
  "PLAN" [label="{PLAN|PK id\lUK nombre: string\l   precio mensual: double\l   descripción: string\l   incluye análisis avanzado: string\l}"];
  "IMAGEN" [label="{IMAGEN|PK id\lUK url: string\l   tamaño en KB: int\l   resolución: string\l   fecha de captura: date\l   procesada: string\l}"];
  "MAPA PARCELA" [label="{MAPA PARCELA|PK id\lFK usuario\lFK zona geográfica\lUK imagen mapa: string\l   ancho: int\l   alto: int\l   fecha subida: date\l   nombre: string\l   comentarios: string\l}"];
  "UBICACIÓN" [label="{UBICACIÓN|PK id\lFK mapa parcela\l   coordenada X: double\l   coordenada Y: double\l   comentario: string\l}"];
  "CAPTURA" [label="{CAPTURA|PK id\lFK usuario\lFK imagen\lFK ubicación\l   fecha: date\l   notas: string\l}"];
  "CULTIVO" [label="{CULTIVO|PK id\lUK nombre: string\l   descripción: string\l}"];
  "PLAGA" [label="{PLAGA|PK id\lUK nombre: string\l   descripción: string\l   tipo: string\l   gravedad: string\l}"];
  "DIAGNÓSTICO" [label="{DIAGNÓSTICO|PK id\lFK captura\lFK plaga\lFK cultivo\l   nivel de daño: double\l   confianza: double\lFK modelo ia: string\l   fecha: date\l}"];
  "MODELO IA" [label="{MODELO IA|PK id\l   nombre: string\l   versión: double\l   fecha de entrenamiento: date\l   tipo de modelo: string\l}"];
  "ETIQUETA MANUAL" [label="{ETIQUETA MANUAL|PK id\lFK diagnóstico\lFK usuario\l   plaga corregida: string\l   observaciones: string\l   fecha: date\l}"];
  "ZONA GEOGRÁFICA" [label="{ZONA GEOGRÁFICA|PK id\lUK nombre: string\l   tipo de zona: string\l   región: string\l}"];
  "CAPA MAPA" [label="{CAPA MAPA|PK id\lFK usuario\l   nombre: string\l   tipo de visualización: string\l   filtros aplicados: string\l}"];
  "MAPA CALOR CACHE" [label="{MAPA CALOR CACHE|PK id\l   fecha: date\lFK zona geográfica\lFK plaga\lFK cultivo\l   nivel de infestación: double\l   fuente: string\l}"];
  "ESTADÍSTICA AGREGADA" [label="{ESTADÍSTICA AGREGADA|PK id\l   fecha: date\lFK zona geográfica\lFK cultivo\lFK plaga\l   total casos: int\l   media daño: double\l}"];
  "EVENTO USUARIO" [label="{EVENTO USUARIO|PK id\lFK usuario\l   acción: string\l   fecha y hora: date\l   detalles: string\l}"];
  "ALERTA" [label="{ALERTA|PK id\l   tipo: string\l   mensaje: string\l   gravedad: string\l   fecha generada: date\l   estado: string\l}"];
  "USUARIO ALERTA" [label="{USUARIO ALERTA|PK id\lFK usuario\lFK alerta\l   leída: string\l   fecha de lectura: date\l}"];
  "RECOMENDACIÓN" [label="{RECOMENDACIÓN|PK id\lFK plaga\lFK cultivo\l   nivel de daño: double\l   acción sugerida: string\l}"];
  "RECOMENDACIÓN APLICADA" [label="{RECOMENDACIÓN APLICADA|PK id\lFK usuario\lFK recomendación\l   fecha: date\l   comentarios: string\l}"];
  "CLIMA" [label="{CLIMA|PK id\l   fecha: date\lFK zona geográfica\l   temperatura: double\l   humedad: double\l   lluvia: double\l   fuente: string\l}"];
  "PREDICCIÓN" [label="{PREDICCIÓN|PK id\lFK plaga\lFK zona geográfica\l   fecha estimada: date\l   probabilidad: double\lFK modelo ia\l}"];
  "TÉCNICO PRODUCTOR" [label="{TÉCNICO PRODUCTOR|PK id\lFK usuario\lFK usuario\l   fecha asignación: date\l   estado: string\l}"];
  "MENSAJE CHAT" [label="{MENSAJE CHAT|PK id\lFK usuario\lFK usuario\l   contenido: string\l   fecha y hora: date\l}"];
  "ANOTACIÓN TÉCNICO" [label="{ANOTACIÓN TÉCNICO|PK id\lFK captura\lFK usuario\l   comentario: string\l   fecha: date\l}"];
  "API KEY" [label="{API KEY|PK id\lFK usuario\l   clave: string\l   fecha de emisión: date\l   activa: string\l   nivel de acceso: string\l}"];
  "USO API LOG" [label="{USO API LOG|PK id\lFK api key\l   fecha y hora: date\l   endpoint: string\l   éxito: string\l   mensaje de respuesta: string\l}"];
  "DATOS OFFLINE BUFFER" [label="{DATOS OFFLINE BUFFER|PK id\lFK usuario\l   tipo de dato: string\l   contenido: string\l   fecha de creación: date\l   sincronizado: string\l}"];
  "SYNC LOG" [label="{SYNC LOG|PK id\lFK usuario\l   fecha: date\l   tipo de sincronización: string\l   resultado: string\l}"];
  "USUARIO" -> "USUARIO ROL" [label="1:N"];
  "ROL" -> "USUARIO ROL" [label="1:N"];
  "USUARIO" -> "SUSCRIPCIÓN" [label="1:N"];
  "PLAN" -> "SUSCRIPCIÓN" [label="1:N"];
  "USUARIO" -> "MAPA PARCELA" [label="1:N"];
  "ZONA GEOGRÁFICA" -> "MAPA PARCELA" [label="1:N"];
  "MAPA PARCELA" -> "UBICACIÓN" [label="1:N"];
  "USUARIO" -> "CAPTURA" [label="1:N"];
  "IMAGEN" -> "CAPTURA" [label="1:N"];
  "UBICACIÓN" -> "CAPTURA" [label="1:N"];
  "CAPTURA" -> "DIAGNÓSTICO" [label="1:N"];
  "PLAGA" -> "DIAGNÓSTICO" [label="1:N"];
  "CULTIVO" -> "DIAGNÓSTICO" [label="1:N"];
  "MODELO IA" -> "DIAGNÓSTICO" [label="1:N"];
  "DIAGNÓSTICO" -> "ETIQUETA MANUAL" [label="1:N"];
  "USUARIO" -> "ETIQUETA MANUAL" [label="1:N"];
  "USUARIO" -> "CAPA MAPA" [label="1:N"];
  "ZONA GEOGRÁFICA" -> "MAPA CALOR CACHE" [label="1:N"];
  "PLAGA" -> "MAPA CALOR CACHE" [label="1:N"];
  "CULTIVO" -> "MAPA CALOR CACHE" [label="1:N"];
  "ZONA GEOGRÁFICA" -> "ESTADÍSTICA AGREGADA" [label="1:N"];
  "CULTIVO" -> "ESTADÍSTICA AGREGADA" [label="1:N"];
  "PLAGA" -> "ESTADÍSTICA AGREGADA" [label="1:N"];
  "USUARIO" -> "EVENTO USUARIO" [label="1:N"];
  "USUARIO" -> "USUARIO ALERTA" [label="1:N"];
  "ALERTA" -> "USUARIO ALERTA" [label="1:N"];
  "PLAGA" -> "RECOMENDACIÓN" [label="1:N"];
  "CULTIVO" -> "RECOMENDACIÓN" [label="1:N"];
  "USUARIO" -> "RECOMENDACIÓN APLICADA" [label="1:N"];
  "RECOMENDACIÓN" -> "RECOMENDACIÓN APLICADA" [label="1:N"];
  "ZONA GEOGRÁFICA" -> "CLIMA" [label="1:N"];
  "PLAGA" -> "PREDICCIÓN" [label="1:N"];
  "ZONA GEOGRÁFICA" -> "PREDICCIÓN" [label="1:N"];
  "MODELO IA" -> "PREDICCIÓN" [label="1:N"];
  "USUARIO" -> "TÉCNICO PRODUCTOR" [label="1:N"];
  "USUARIO" -> "TÉCNICO PRODUCTOR" [label="1:N"];
  "USUARIO" -> "MENSAJE CHAT" [label="1:N"];
  "USUARIO" -> "MENSAJE CHAT" [label="1:N"];
  "CAPTURA" -> "ANOTACIÓN TÉCNICO" [label="1:N"];
  "USUARIO" -> "ANOTACIÓN TÉCNICO" [label="1:N"];
  "USUARIO" -> "API KEY" [label="1:N"];
  "API KEY" -> "USO API LOG" [label="1:N"];
  "USUARIO" -> "DATOS OFFLINE BUFFER" [label="1:N"];
  "USUARIO" -> "SYNC LOG" [label="1:N"];
}